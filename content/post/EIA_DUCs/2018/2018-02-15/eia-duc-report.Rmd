---
title: EIA DUC Report
author: David Maupin
date: '2018-02-15'
categories:
  - Drilled and Completed
  - DUCs
tags:
  - EIA DUC Report
slug: eia-duc-report
---
####**Overview of EIA DUC Inventory Report**
* A drilled but uncompleted well (DUC) is a new well after the end of the drilling process, but its first completion process has not been concluded.
* EIA uses **20 days** to estimate days to TD. This likely **overestimates** DUC inventory in basins where PAD drilling is predominant.
* Report tracks monthly changes in DUC inventory beginning in 2014.

####**Permian Monthly Highlights**
* Permian Basin ended December with **~2,880 wells waiting on completion.** 
* The DUC to completion ratio is stabilizing at ~7:1. 

```{r, echo=F, warning=F, message=F}
library(tidyverse)
library(openxlsx)
library(data.table)
library(scales)
library(zoo)
```

```{r, echo=F, warning=F, message=F}
DUC= read.xlsx("ducs.xlsx",colNames = F, sheet=1)

#Remove First rows

N=2
DUC_f= tail(DUC,-2)

DUC_f$X1= as.Date(as.numeric(DUC_f$X1), origin= "1899-12-31")

##filter columns and seperate into individual datasets

#Anadarko
Anadarko= DUC_f[,c(1:4)]
Anadarko= tail(Anadarko,-1)

#Convert character columns to numeric
Anadarko= taRifx::japply(Anadarko, which(sapply(Anadarko, class)=="character"),as.numeric)

#Rename columns
Anadarko= data.table::setnames(Anadarko, old=c("X1","X2","X3","X4"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
Anadarko$Basin= "Anadarko"

#Bakken
Bakken= DUC_f[,c(1,8:10)]
Bakken= tail(Bakken,-1)

#Convert character columns to numeric
Bakken= taRifx::japply(Bakken, which(sapply(Bakken, class)=="character"),as.numeric)

#Rename columns
Bakken= data.table::setnames(Bakken, old=c("X1","X8","X9","X10"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
Bakken$Basin= "Bakken"


#Eagle_Ford
Eagle_Ford= DUC_f[,c(1,11:13)]
Eagle_Ford= tail(Eagle_Ford,-1)

#Convert character columns to numeric
Eagle_Ford= taRifx::japply(Eagle_Ford, which(sapply(Eagle_Ford, class)=="character"),as.numeric)

#Rename columns
Eagle_Ford= data.table::setnames(Eagle_Ford, old=c("X1","X11","X12","X13"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
Eagle_Ford$Basin= "Eagle Ford"


#Haynesville
Haynesville= DUC_f[,c(1,14:16)]
Haynesville= tail(Haynesville,-1)

#Convert character columns to numeric
Haynesville= taRifx::japply(Haynesville, which(sapply(Haynesville, class)=="character"),as.numeric)

#Rename columns
Haynesville= data.table::setnames(Haynesville, old=c("X1","X14","X15","X16"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
Haynesville$Basin= "Haynesville"


#Niobrara
Niobrara= DUC_f[,c(1,17:19)]
Niobrara= tail(Niobrara,-1)

#Convert character columns to numeric
Niobrara= taRifx::japply(Niobrara, which(sapply(Niobrara, class)=="character"),as.numeric)

#Rename columns
Niobrara= data.table::setnames(Niobrara, old=c("X1","X17","X18","X19"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
Niobrara$Basin= "Niobrara"


#Permian
Permian= DUC_f[,c(1,20:22)]
Permian= tail(Permian,-1)

#Convert character columns to numeric
Permian= taRifx::japply(Permian, which(sapply(Permian, class)=="character"),as.numeric)

#Rename columns
Permian= data.table::setnames(Permian, old=c("X1","X20","X21","X22"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
Permian$Basin= "Permian"


#Marcellus
#Marcellus= DUC_f[,c(1,26:28)]
#Marcellus= tail(Marcellus,-1)

#Convert character columns to numeric
#Marcellus= taRifx::japply(Marcellus, which(sapply(Marcellus, class)=="character"),as.numeric)

#Rename columns
#Marcellus= data.table::setnames(Marcellus, old=c("X1","X26","X27","X28"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
#Marcellus$Basin= "Marcellus"

#Utica
#Utica= DUC_f[,c(1,29:31)]
#Utica= tail(Utica,-1)

#Convert character columns to numeric
#Utica= taRifx::japply(Utica, which(sapply(Utica, class)=="character"),as.numeric)

#Rename columns
#Utica= data.table::setnames(Utica, old=c("X1","X29","X30","X31"), new= c('Date','Drilled','Completed','DUC'))

#Add Basin Column
#Utica$Basin= "Utica"
```

```{r, echo=F, warning=F, message=F}
#Merge Tables
AllTables= list(Anadarko,Bakken,Eagle_Ford,Haynesville,Niobrara,Permian)

AllBasins= Reduce(function(...) merge(..., all=T), AllTables)
AllBasins$DUC_CompRatio= AllBasins$DUC/AllBasins$Completed
AllBasins$Drilled_CompRatio= AllBasins$Drilled/AllBasins$Completed
AllBasins= AllBasins %>% mutate(DUC_CompRatio= replace(DUC_CompRatio,which(is.na(DUC_CompRatio)),0))
AllBasins= AllBasins %>% group_by(Basin)%>% arrange(Basin,Date)%>% mutate(SixMonthAvg=rollmean(x=DUC_CompRatio,6,
  align='right',fill=NA)) %>% ungroup()


#Set up date breaks
lims <- as.POSIXct(strptime(c("2014-01-01","2017-12-31"), format = "%Y"))
```

```{r, echo=F, warning=F, message=F}
####Remember to update limits date to current month###
P1=ggplot(subset(AllBasins, Date<="2016-01-02"), aes(Date, DUC, group=Basin, color=Basin, frame=Date))+geom_line(size=2)+facet_wrap(~Basin, scales="free")+
  theme_minimal()+scale_color_manual(values=c("#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC"))+
  geom_line(data=subset(AllBasins, Basin %in% c("Permian") & Date >="2016-01-02"), aes(Date,DUC,frame=Date),
  size=2, color="red", fill= "red")+geom_line(data=subset(AllBasins, Basin %in% c("Eagle Ford") & Date >="2016-01-02"), aes(Date,DUC,frame=Date),
  size=2, color="blue", fill= "blue")+ geom_path(aes(cumulative = TRUE, group = Basin))+theme(legend.position = "none")+
  geom_line(data=subset(AllBasins, Basin %in% c("Bakken","Haynesville","Marcellus","Utica","Niobrara","Anadarko") & Date >="2016-01-02"), aes(Date,DUC,frame=Date),
  size=2, color="blue", fill= "blue")+ scale_x_date(breaks= pretty_breaks(), limits = as.Date(c(
  '2014-01-01','2018-01-01')))+ theme(strip.text.x = element_text(size = 12))+scale_y_continuous(labels=comma)+
  scale_x_date(breaks= pretty_breaks(), limits = as.Date(c('2014-01-01','2018-01-01')))+ 
  theme(strip.text.x = element_text(size = 12))+scale_y_continuous(labels=comma, breaks= pretty_breaks())+
  labs(y="Number of DUCS", title="DUC Inventory By Basin",subtitle="EIA includes any well in DUC inventory after 20 days since reported spud date.",
  caption="Sourced from EIA")+theme(plot.title=element_text(size=14, face="bold", vjust=-3),
  plot.subtitle=element_text(face="italic",size=10, vjust=-1),
  plot.caption=element_text(hjust=0))

#gganimate::gg_animate(P1, interval=.3, "Basins.gif", ani.width = 725, ani.height = 500)


P2=ggplot(subset(AllBasins, Date<="2016-01-02"), aes(Date, DUC_CompRatio, group=Basin, color=Basin, frame=Date))+geom_line(size=2,show.legend = )+facet_wrap(~Basin, scales="free")+
  theme_minimal()+scale_color_manual(values=c("#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC","#CCCCCC"))+
  geom_line(data=subset(AllBasins, Basin %in% c("Permian") & Date >="2016-01-02"), aes(Date,DUC_CompRatio,frame=Date),
  size=2, color="red", fill= "red")+geom_line(data=subset(AllBasins, Basin %in% c("Eagle Ford") & Date >="2016-01-02"), aes(Date,DUC_CompRatio,frame=Date),
  size=2, color="blue", fill= "blue")+ geom_path(aes(cumulative = TRUE, group = Basin))+theme(legend.position = "none")+
  geom_line(data=subset(AllBasins, Basin %in% c("Bakken","Haynesville","Marcellus","Utica","Niobrara","Anadarko") & Date >="2016-01-02"), aes(Date,DUC_CompRatio,frame=Date),
  size=2, color="blue", fill= "blue")+ scale_x_date(breaks= pretty_breaks(), limits = as.Date(c(
  '2014-01-01','2018-01-01')))+ 
  geom_line(data=subset(AllBasins, Date>"2014-06-02"), aes(Date,SixMonthAvg),color='black',linetype=7, size=.5, show.legend = T)+
  theme(strip.text.x = element_text(size = 12))+scale_y_continuous(labels=comma, breaks= pretty_breaks())+
  labs(y="DUC Completion Ratio", title="DUC To Completion Ratio",subtitle="At the end of 2014, DUC/Completion Ratio was around 2:1 for oil regions and 4:1 for gas regions.",
  caption="Sourced from EIA")+
  theme(plot.title=element_text(size=14, face="bold", vjust=-3),
  plot.subtitle=element_text(face="italic",size=10, vjust=-1),plot.caption=element_text(hjust=0))+ expand_limits(y=0)


#All Regions Drilled and Completed 
P3=ggplot()+geom_area(data=AllBasins, aes(Date,Drilled,fill="Drilled" ), stat='identity', alpha=.75,show.legend =T)+theme_minimal()+
  geom_line(data=AllBasins, aes(Date,Completed, color="Completed" ), size=2)+facet_wrap(~Basin, scales="free")+
  scale_x_date(breaks= pretty_breaks(), limits = as.Date(c('2014-01-01','2018-01-01')))+ theme(strip.text.x = element_text(size = 12))+scale_y_continuous(labels=comma, breaks= pretty_breaks())+
  labs(y="Well Count", title="Drilled and Completed Wells",subtitle=" ",
  caption="Sourced from EIA")+
  theme(plot.title=element_text(size=14, face="bold", vjust=-3),
  plot.subtitle=element_text(face="italic",size=10, vjust=-1),plot.caption=element_text(hjust=0))+ expand_limits(y=0)+
  scale_colour_manual(name="Line Legend",values=c("Completed"="red"),guide = guide_legend(override.aes=aes(fill=NA)))+
  scale_fill_manual(name="Area Legend",values=c("Drilled"="black"))+theme(legend.position = c(.82, 1.16),legend.box="horizontal")
```
<br>
<br>
```{r, echo=F, warning=F, message=F}
P1
```
<br>
<br>
```{r, echo=F, warning=F, message=F}
P2
```
<br>
<br>
<br>
```{r, echo=F, warning=F, message=F}
P3
```
<br>
<br>
