---
title: Flowback Methods in the Permian
author: David Maupin
date: '2018-04-23'
slug: flowback-methods-in-the-permian
categories:
  - Peer Analysis
  - Flowback
tags:
  - Competior Analysis
  - Flowback
---

####**Methodology**

* Analyze completion filings obtained from NMOCD to gain a better understanding of flowback strategies by our peers.
* Operators included in the dataset are Concho, Centennial, Devon, EOG, Matador, Mewbourne and Oxy.
* Completion data is from 2017-Current.


####**Highlights**

* Many of our peers are flowing up casing…not just EOG.
* Choke size appears to be highly coorelated to fluid volumes.
* Althougth Mewboune’s wells are flowing up casing, they are choking their wells back considerably. Range of sizes are from 12/64"-30/64".
* Also, Oxy’s Cedar Canyon has produced over 800K barrels of fluid in just two months (Jan-Feb 2018), I had to triple check that figure.
*   


```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.align = 'center',echo=F,warning=F,message=F,asis=F)
```






```{r}
library(openxlsx)
library(tidyverse)
library(scales)
library(crosstalk)
library(plotly)
library(leaflet)
library(htmltools)
```


```{r}
permian<- read.xlsx("Permian_Flowing_Master.xlsx",sheet=1)
```

```{r}
permian_size<- permian%>% group_by(UWI)%>% mutate(Size_Rank= rank(as.numeric(Size)))%>%filter(Size_Rank==1)


permian_size<- permian_size%>% mutate(Flow.Gas.Value= replace(Flow.Gas.Value,which(is.na(Flow.Gas.Value)),0))%>%  mutate(Flow.Oil.Value= replace(Flow.Oil.Value,which(is.na(Flow.Oil.Value)),0))%>% mutate(Flow.Condensate.Value= replace(Flow.Condensate.Value,which(is.na(Flow.Condensate.Value)),0))%>%mutate(Flow.Water.Value= replace(Flow.Water.Value,which(is.na(Flow.Water.Value)),0))

permian_size$Comp_Date<- as.Date(permian_size$Comp_Date,origin = "1899-12-30")
permian_size$Size<- as.numeric(permian_size$Size)

permian_size<- permian_size%>% filter(Size< 8 & !is.na(Choke_Size))


```



```{r}
delaware<- permian_size%>% group_by(UWI)%>% filter(Latitude>32.000367 & Longitude < -103.064750)%>%ungroup()

delaware<- delaware%>% group_by(Alias)%>% mutate(WellCnt= max(dense_rank(UWI)))%>% filter(WellCnt>5)

```


```{r}
ggplot(data= subset(delaware,!is.na(Size)),aes(Alias,fill=as.character(Size)))+geom_bar()+theme_minimal()+ scale_fill_brewer(palette='Set2',labels=c("2 3/8","2 7/8","3 1/2","4 1/2","5","5 1/2"),name= "Casing/Tubing Size")+ theme(legend.position = 'bottom')+ggtitle("Flowback Methods in the Northern Delaware (NM)",subtitle = 'Majority of EOG, Mewbourne, Matador and Oxy wells flow up casing.')+ylab("Well Count")+labs(caption="Data sourced from NMOCD Well Filings (C-104 & C-105) and IHS")+xlab("")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
ggplot(data=subset(delaware, !is.na(Size)), aes(Choke_Size,Total.Volume,size=as.character(Size),color=Alias))+geom_point(alpha=.65)+ theme_minimal()+theme(axis.text.x = element_text(angle = 90, hjust = 1))+scale_color_brewer(palette='Set3',name= "")+scale_size_discrete(breaks=c(2.375,2.875,3.5,4.5,5,5.5),labels=c("2 3/8","2 7/8","3 1/2","4 1/2","5","5 1/2"),name="Casing\nTubing Size")+guides(size=guide_legend(ncol=3))+ 
  geom_point(data=subset(delaware, Alias=="MEW" & !is.na(Size)), aes(Choke_Size,Total.Volume,size=as.character(Size)),color='black',pch=21)+
  geom_smooth(method=lm,na.rm=T,aes(group=1),se=F,color='red',show.legend = F)+
  guides(colour = guide_legend(override.aes = list(size=5)))+ggtitle("Choke Size Versus Total Initial Volume",subtitle= "Mewbourne appears to be using choke size to control fluid volumes.")+labs(caption="Data sourced from NMOCD Well Filings (C-104 & C-105) and IHS.")+theme(legend.position = 'bottom')+scale_y_continuous(labels=comma)+
  theme(legend.title.align = 0.5)+ylab("Total Volume (Bbls)")+xlab("Choke Size")
```





```{r}
colnames(permian_size)[15]='lat'
colnames(permian_size)[16]='lng'


#pal <- c('#ff9966', "#1a75ff","#00ff00")
#Type<- unique(permian_size$Type)

#colors<- data.frame(pal,Type)
#colors$type<- as.character(colors$Type)
#permian_size<- left_join(permian_size,colors)


permian_size$Reset_Filter<-"RESET"

sd<-SharedData$new(permian_size)



factpal <- colorFactor(c('#ff9966', "#1a75ff","#00ff00"), domain=permian_size$Type)


```

```{r}
labs <- lapply(seq(nrow(permian_size)), function(i) {
  paste0("Company: ", permian_size[i, "Alias"], '<p>',
         "Casing/Tubing Size: ", permian_size[i, "Size"],'<p>',
         "Well Name: ", permian_size[i, "Lease"],permian_size[i, "Well_Number"],'<p>',
         "Total Fluid (Bbls): ",permian_size[i, "Total.Volume"])})

p1<-leaflet(sd)%>% addTiles(group = "Esri.WorldTopoMap")%>%
  addProviderTiles(providers$Esri.WorldTopoMap)%>%
  addCircleMarkers(fillColor =~factpal(Type) ,stroke=NA,radius=6,fillOpacity =.75,label=lapply(labs,HTML))%>%
   addLegend('topright',pal=factpal,values=permian_size$Type,title="DRILLING STRING",opacity=1)


p2<-plot_ly(sd,x=~Choke_Size,y=~Total.Volume,size=~Size,color=~Type)%>% add_markers(color=~Type,colors=c('#ff9966', "#1a75ff","#00ff00"),marker=list(sizeref=6, sizemode="Size"),text=~paste("Casing/Tubing Size: ",Size,"<br>",
                            "Type: ",Type,"<br>",
                             "Company: ", Alias,"<br>",
                             "Lease Name: ",Lease))%>%
         layout(showlegend=F)%>%
  layout(dragmode = "select", margin = list(b = 70)) 

p3<-plot_ly(sd,x = ~Alias,
  type = "histogram",
  color=~Type)%>% layout(title='Well Count by Flowing Method Type')



```

```{r}
options(persistent=T)

browsable(tags$div(
  style = "display: flex; flex-wrap: wrap",
  tagList(
    tags$div(filter_select("Company","Alias",sd,~Alias), style = "width: 25%; padding: 1em; float:left"),
    tags$div(p1, style = "width: 75%; padding: 1em; float:right"),
    tags$div(filter_select("Reset Filter","Reset Filter",sd,~ifelse(Reset_Filter=="RESET","YES","NO")), style = "width: 25%; padding: 1em; float:left"),
    tags$div(p2, style = "width: 100%; padding: 1em;clear:both"))
)
)


```


